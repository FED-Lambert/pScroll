<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0, minimum-scale=1.0, maximum-scale=1.0">
    <meta name="description" content="">
    <meta name="keywords" content="">
    <meta name="format-detection" content="telephone=no,address=no,email=no">
    <!-- <meta name="apple-itunes-app" content="app-id=" /> -->
    <!-- <link rel="apple-touar-icon" sizes="114x114" href="" /> -->
    <title> 模板页 </title>
    <!-- 自定义样式 start -->
    <link href="css/demo.css" rel="stylesheet">
    <!-- 自定义样式 end -->
</head>
<body>
<script type="text/javascript">
    if(/Android|webOS|iPhone|Windows Phone|iPod|BlackBerry|SymbianOS/i.test(window.navigator.userAgent) && !/[\?&]pc(?:[=&].*|$)/.test(window.location.href)){
        document.body.className = 'is-mobi';
    } else {
        document.body.className = 'is-pc';
    }
</script>
<div class="ui-pc">
    <div class="ui-tips">
        <img src="demo.png" height="100" width="100"/>
        <h3>The demo page should be viewed by mobile</h3>
    </div>
</div>
<div class="ui-mobi">
    <article>
        <div class="ui-list">
            <div class="ui-list__header">A demo menu of pScroll</div>
            <ul>
                <li class="ui-list__arrow">
                    <a href="javascript:">Demo 1</a>
                    <span>纵向翻页</span>
                    <span>回调动画</span>
                    <span>页面跳转</span>
                </li>
                <li class="ui-list__arrow">
                    <a href="javascript:">Demo 2</a>
                    <span>横向翻页</span>
                    <span>结合Lego-Mobile Tab</span>
                </li>
                <li class="ui-list__arrow">
                    <a href="javascript:">Demo 3</a>
                    <span>纵向翻页</span>
                    <span>循环翻页</span>
                    <span>自定义窗口</span>
                </li>
            </ul>
        </div>
    </article>
    <article>
        <div class="ui-demo is-demo1">
            <div class="ui-input">
                <select>
                    <option selected>0</option>
                    <option>1</option>
                    <option>2</option>
                </select>
            </div>
            <div class="ui-wrap">
                <div class="ui-plist">
                    <section>
                        <div><h3>Demo 1</h3><h4>Page 1</h4></div>
                        <em>slideend</em>
                    </section>
                    <section>
                        <div><h3>Demo 1</h3><h4>Page 2</h4></div>
                        <em>slideend</em>
                    </section>
                    <section>
                        <div><h3>Demo 1</h3><h4>Page 3</h4></div>
                        <em>slideend</em>
                    </section>
                </div>
            </div>
        </div>
        <div class="ui-demo is-demo2" id="tab">
            <div class="mod-tab">
                <div class="mod-tab__hd" data-js="nav">
                    <div class="mod-tab__hdItem act">01</div>
                    <div class="mod-tab__hdItem">02</div>
                    <div class="mod-tab__hdItem">03</div>
                </div>
            </div>
            <div class="ui-wrap">
                <div class="ui-plist" data-js="content">
                    <section><div><h3>Demo 2</h3><h4>Page 1</h4></div></section>
                    <section><div><h3>Demo 2</h3><h4>Page 2</h4></div></section>
                    <section><div><h3>Demo 2</h3><h4>Page 3</h4></div></section>
                </div>
            </div>
        </div>
        <div class="ui-demo is-demo3">
            <div class="ui-wrap">
                <div class="ui-plist">
                    <section><div><h3>Demo 3</h3><h4>Page 1</h4></div></section>
                    <section><div><h3>Demo 3</h3><h4>Page 2</h4></div></section>
                    <section><div><h3>Demo 3</h3><h4>Page 3</h4></div></section>
                </div>
            </div>
        </div>
        <a class="ui-exit" href="javascript:">Go back</a>
    </article>
</div>
<script type="text/javascript" src="js/sea.js"></script>
<script type="text/javascript">
    seajs.config({
        paths: {
            'legoPath': 'http://assets.dwstatic.com/mobile/src/js/',
            'modulePath': 'http://assets.dwstatic.com/legomobi/3.0.0/js/'
        },
        alias: {
            'zepto': 'legoPath/main/zepto/zepto.min.js',
            'touch': 'legoPath/main/zepto/zepto.touch.js',
            'iscroll': 'legoPath/module/iscroll/iscroll.js',
            'pScroll': 'pScroll.js'
        }
    })
</script>
<script type="text/javascript">
    seajs.use(['modulePath/tab','pScroll'], function(Tab, pScroll) {
        if ($('body').hasClass('is-pc')) {
            return
        }
        var demo = new pScroll({
            wrap : '.ui-mobi',
            trigger : '.ui-mobi',
            axis : 'x',
            speed : 800,
            slidestart : function( to ) {
                if (to == 0) {
                    li.filter('.is-on').removeClass('is-on');
                    task[uidemo.filter('.is-on').index()].off();
                }
            },
            slideend : function( index ) {
                if (index == 0) {
                    uidemo.removeClass('is-on');
                }
            }
        }).off();
        var li = $('.ui-list li');
        li.on('webkitTransitionEnd', function ( e ) { return false });
        var uidemo = $('.ui-demo');
        var plist = uidemo.find('.ui-plist');
        var em = $('em');
        var task = [
            new pScroll({
                wrap : plist.eq(0),
                trigger : plist.eq(0),
                prevent : false,
                slidestart : function(to, from){
                    if (to != from) {
                        $('select').val(to);
                        $(this).removeClass('is-on');
                    }
                },
                slideend : function(){
                    $(this).addClass('is-on');
                }
            }).off(),
            new pScroll({
                wrap : plist.eq(1),
                trigger : plist.eq(1),
                prevent : false,
                axis : 'x',
                slidestart : function(to, from){
                    if (to != from) {
                        $('.mod-tab__hdItem').eq(to).addClass('act').siblings().removeClass('act');
                    }
                }
            }).off(),
            new pScroll({
                wrap : plist.eq(2),
                trigger : plist.eq(2),
                prevent : false,
                loop : true
            }).off()
        ];
        $('.ui-list').on('touchstart', 'li', function(e){
            $(this).addClass('is-active');
        }).on('touchend', 'li', function(){
            var index = $(this).removeClass('is-active').addClass('is-on').index();
            uidemo.eq(index).addClass('is-on');
            task[index].on();
            setTimeout(demo.goPage.bind(demo, 1), 100);
        })
        $('.ui-exit').on('touchstart', function(){
            $(this).addClass('is-active');
        }).on('touchend', function(){
            $(this).removeClass('is-active');
            demo.goPage(0);
        })
        $('select').on('change', function(){
            task[0].goPage(this.value);
        })
        $('[data-js="nav"]').on('touchstart', '.mod-tab__hdItem', function(){
            task[1].goPage($(this).index());
        })
    })
</script>
</body>
</html>
